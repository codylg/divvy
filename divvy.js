function decimalize(e){var a=e.toFixed(2);return a}function indexOfLowest(e){for(var a=0,n=1;n<e.length;n++)e[n]<e[a]&&(a=n);return a}function indexOfGreatest(e){for(var a=0,n=1;n<e.length;n++)e[n]>e[a]&&(a=n);return a}function costpress(){var e=0,a=0,n=new Array,t=new Array,s=new Array;$(".payment-summary").empty(),$(".person").each(function(){var s=0;$(this).find(".expense-cost").each(function(){s+=Number($(this).val())}),e+=s,a++;var r=$(this).find(".name").val();r?n.push(r):n.push("Some Guy"),t.push(s),$(this).find(".expense-total").text(decimalize(s))});var r=e/a;if(n.forEach(function(e,a){var n=t[a]-r;s.push(n)}),n.length>1&&0!=e){for(;s[indexOfLowest(s)]<-.01;){var d=n[indexOfLowest(s)],o=n[indexOfGreatest(s)],i=s[indexOfLowest(s)],l=s[indexOfGreatest(s)];Math.abs(i)<=l?($(".payment-summary").append("<h3>"+d+" owes "+o+" "+decimalize(Math.abs(i))+"</h3>"),s[indexOfGreatest(s)]=l+i,s[indexOfLowest(s)]=0):($(".payment-summary").append("<h3>"+d+" owes "+o+" "+decimalize(l)+"</h3>"),s[indexOfLowest(s)]=i+l,s[indexOfGreatest(s)]=0)}$(".cost-summary").removeClass("hidden"),$(".add-expenses").addClass("hidden"),$(".add-more-people").addClass("hidden"),$(".cost-total").text(decimalize(e)),$(".number-of-people").text(a),$(".cost-share").text(decimalize(r))}else n.length>1?($(".cost-summary").addClass("hidden"),$(".add-expenses").removeClass("hidden"),$(".add-more-people").addClass("hidden")):($(".cost-summary").addClass("hidden"),$(".add-expenses").addClass("hidden"),$(".add-more-people").removeClass("hidden"))}function getRandName(){var e=Math.floor(Math.random()*names.length),a=names[e];return names.splice(e,1),a}$("body").on("input","input",function(){costpress()});var expenseTemplate=$("#expense-template").removeAttr("id").clone();$("body").on("click",".add-expense",function(){expenseTemplate.clone().insertBefore(this)});var names=["Alex","Alma","Amy","Andy","Archy","Arlie","Audrey","Celia","Charlie","Clara","Cora","Edward","Ellen","Emily","Emma","Esther","Ethan","Ethel","Ezra","Frances","Grace","Hamish","Harry","Helen","Ira","Jacob","Jess","Joseph","Leo","Lillian","Lucian","Malcolm","Maurice","Natalie","Peta","Reed","Rowan","Ruhul","Ryan","Savannah","Vera","Vernon","Walter"];$(".person").each(function(){$(this).find(".name").val(getRandName())});var personTemplate=$("#person-template").removeAttr("id").clone();$(".add-person").click(function(){personTemplate.clone().insertBefore(this).find(".name").val(getRandName),costpress()}),$("body").on("click",".remove-control",function(){$(this).parent().remove(),costpress()});
